<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <title>Tracking Preference Expression (DNT)</title>
  <meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
  <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class='remove' async></script>
  <script class='remove'>
    var respecConfig = {
      specStatus:          "ED",
      shortName:           "tracking-dnt",
      // publishDate:         "2017-03-13",
      previousPublishDate: "2015-08-20",
      previousMaturity:    "CR",
      edDraftURI:          "https://w3c.github.io/dnt/drafts/tracking-dnt.html",
      prevED : "https://www.w3.org/2011/tracking-protection/drafts/tracking-dnt.html",
      editors:  [
          { name: "Roy T. Fielding", url: "http://roy.gbiv.com/",
            company: "Adobe", companyURL: "https://www.adobe.com/",
            w3cid: 31828 },
          { name: "David Singer",
            company: "Apple", companyURL: "https://www.apple.com/",
            w3cid: 11534 }
      ],
      wg:          "Tracking Protection Working Group",
      wgURI:       "https://www.w3.org/2011/tracking-protection/",
      wgPublicList: "public-tracking",
      wgPatentURI: "https://www.w3.org/2004/01/pp-impl/49311/status",
   // issueBase:   "https://www.w3.org/2011/tracking-protection/track/issues/",
      issueBase:   "https://github.com/w3c/dnt/issues",
      githubAPI:   "https://api.github.com/repos/w3c/dnt",
      processVersion: 2017,
      localBiblio: {
        "TCS": {
          "authors": ["Nick Doty","Heather West","Justin Brookman","Sean Harvey","Erica Newland"],
          "status" : "WD",
          "href"   : "https://www.w3.org/TR/tracking-compliance/",
       // "status" : "ED",
       // "href"   : "https://www.w3.org/2011/tracking-protection/drafts/tracking-compliance.html",
          "title"  : "Tracking Compliance and Scope",
          "date"   : "31 March 2015",
          "publisher" : "W3C"
        },
        "KnowPrivacy": {
          "authors": ["Joshua Gomez","Travis Pinnick","Ashkan Soltani"],
          "href"   : "http://www.knowprivacy.org/report/KnowPrivacy_Final_Report.pdf",
          "title"  : "KnowPrivacy",
          "date"   : "01 Jun 2009",
          "publisher": "UC Berkeley, School of Information"
        },
        "Orderly": {
          "authors": ["Lloyd Hilaiel"],
          "href"   : "http://orderly-json.org/",
          "title"  : "Orderly JSON",
          "date"   : "10 Feb 2015"
        }
      },
      noIDLSectionTitle: true,
      noLegacyStyle: true
    };
  </script>
  <link rel="stylesheet" href="additional.css" type="text/css" media="screen" title="custom formatting for TPWG editors">
</head>
<body>
  <section id='abstract'>
    <p>
      This specification defines the <a>DNT</a> request header field as an
      HTTP mechanism for expressing the user's preference regarding tracking,
      an HTML DOM property to make that expression readable by scripts, and
      APIs that allow scripts to register site-specific exceptions granted by
      the user. It also defines mechanisms for sites to communicate whether
      and how they honor a received preference through use of the <q>Tk</q>
      response header field and well-known resources that provide a
      machine-readable tracking status.
    </p>
  </section>

  <section id='sotd'>
    <p>
      This document is an editors' straw man reflecting a snapshot of live
      discussions within the
      <a href="https://www.w3.org/2011/tracking-protection/">Tracking
      Protection Working Group</a>.  It does not yet capture all of our work
      and does not constitute working group consensus.
      Text in option boxes (highlighted with light blue background color)
      present options that the group is currently considering, particularly
      where consensus is known to be lacking, and should be read as a set of
      proposals rather than as limitations on the potential outcome.
      An
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/">issue tracking system</a>
      is available for recording
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/raised">raised</a>,
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/open">open</a>,
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/pendingreview">pending review</a>,
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/closed">closed</a>, and
      <a href="https://www.w3.org/2011/tracking-protection/track/issues/postponed">postponed</a>
      issues regarding this document.
    </p>
    <p>
      The following feature is at risk and might be cut from the specification
      during the CR period if there are no (correct) implementations:
    </p>
    <ul>
      <li><a href="#dnt-extensions">DNT-extension</a></li>
    </ul>
  </section>

  <section>
    <h2>Introduction</h2>

    <p>
      The World Wide Web consists of billions of resources interconnected
      through the use of hypertext. Hypertext provides a simple, page-oriented
      view of the information provided by those resources, which can be
      traversed by selecting links, manipulating controls, and supplying data
      via forms and search dialogs.
    </p>
    <p>
      A Web page is often composed of many information sources beyond the
      initial resource request, including embedded references to stylesheets,
      inline images, javascript, and other elements that might be
      automatically requested as part of the rendering or behavioral
      processing defined for that page. The user's experience is seamless,
      even if the page has been composed from the results of many network
      interactions with multiple servers. From the user's perspective, they
      are simply visiting and interacting with a single Web site: all of the
      technical details and protocol mechanisms used to compose a page to
      represent that site are hidden behind the scenes.
    </p>
    <p>
      Web site owners often collect data regarding usage of their sites, for a
      variety of purposes, including what led a user to visit the site
      (<dfn>referrals</dfn>), how effective the user experience is within the
      site (<dfn>web analytics</dfn>), and the nature of who is using the
      site (<dfn>audience segmentation</dfn>).
      In some cases, the data collected is used to dynamically adapt content
      (<dfn>personalization</dfn>) or advertising presented to the user
      (<dfn>targeted advertising</dfn>). Data collection often occurs through
      insertion of embedded elements on each page, resulting in a stream of
      data that connects a user's activity across multiple pages. A survey of
      these techniques and their privacy implications can be found in
      [[KnowPrivacy]].
    </p>
    <p>
      Users need a mechanism to express their own preferences regarding
      <a>tracking</a> that is both simple to configure and efficient when
      implemented. However, merely expressing a preference does not imply that
      all recipients will comply. In some cases, a server might be dependent
      on some forms of tracking and unwilling or unable to turn that off.
      In other cases, a server might perform only limited forms of tracking
      that would be acceptable to most users. Therefore, servers need
      mechanisms for communicating their own tracking behavior, requesting an
      exception to a user's general preference, and storing such a
      <a>user-granted exception</a> after the user has made an informed choice.
    </p>
    <p>
      This specification extends Hypertext Transfer Protocol (HTTP) semantics
      [[!RFC7231]] to communicate a user's tracking preference, if any, and an
      origin server's tracking behavior. The <a>DNT</a> request header field
      is defined for communicating the user's tracking preference for the
      <a>target resource</a>. A well-known URI for a
      <a href="#status-resource">tracking status resource</a> and the
      <a>Tk</a> response header field are defined for communicating the
      server's tracking behavior. In addition, JavaScript APIs are defined for
      enabling scripts to determine DNT status and register a user-granted
      exception.
    </p>
    <p>
      This specification does not define requirements on what a recipient
      needs to do to comply with a user's expressed tracking preference,
      except for the means by which such compliance is communicated. Instead,
      the tracking status provides the ability to identify a set of compliance
      regimes to which the server claims to comply, with the assumption being
      that each regime defines its own requirements on compliant behavior.
      For example, [[TCS]] is a work-in-progress that intends to define such a
      compliance regime.
    </p>
  </section>

  <section id='terminology'>
    <h2>Terminology</h2>

    <section id='terminology.http'>
      <h3>HTTP</h3>

      <p>
        The following terms are used as defined by HTTP/1.1 syntax [[!RFC7230]]
        and semantics [[!RFC7231]]:
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">client</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">server</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">origin server</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">user agent</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">sender</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">recipient</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">request</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">response</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.1">message</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.3">intermediary</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.3">proxy</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-2.3">cache</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-3.2">header field</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7230#section-5.1">target resource</a></dfn>,
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7231#section-2">resource</a></dfn>, and
        <dfn><a class="externalDFN" href="https://tools.ietf.org/html/rfc7231#section-3">representation</a></dfn>.
      </p>
    </section>

    <section id='terminology.activity'>
      <h3>Activity</h3>

      <p>
        <dfn>Tracking</dfn> is the collection of data regarding a particular
        user's activity across multiple distinct contexts and the retention,
        use, or sharing of data derived from that activity outside the
        context in which it occurred.
        A <dfn>context</dfn> is a set of resources that are controlled by
        the same party or jointly controlled by a set of parties.
      </p>
      <p>
        A <dfn>network interaction</dfn> is a single HTTP request and its
        corresponding response(s): zero or more interim (1xx) responses and
        a single final (2xx-5xx) response.
      </p>
      <p>
        A <dfn>user action</dfn> is a deliberate action by the user, via
        configuration, invocation, or selection, to initiate a network
        interaction. Selection of a link, submission of a form, and
        reloading a page are examples of user actions.
        <dfn>User activity</dfn> is any set of such user actions.
      </p>
    </section>

    <section id='terminology.participants'>
      <h3>Participants</h3>

      <p>
        A <dfn>user</dfn> is a natural person who is making, or has made,
        use of the Web.
      </p>
      <p>
        A <dfn>party</dfn> is a natural person, a legal entity, or a set of
        legal entities that share common owner(s), common controller(s), and
        a group identity that is easily discoverable by a user. Common
        branding or providing a list of affiliates that is available via a
        link from a resource where a party describes DNT practices are
        examples of ways to provide this discoverability.
      </p>
      <p>
        With respect to a given user action, a <dfn>first party</dfn>
        is a party with which the user intends to interact, via one or more
        network interactions, as a result of making that action. Merely
        hovering over, muting, pausing, or closing a given piece of content
        does not constitute a user's intent to interact with another party.
      </p>
      <p>
        In some cases, a resource on the Web will be jointly controlled by
        two or more distinct parties. Each of those parties is considered a
        first party if a user would reasonably expect to communicate with
        all of them when accessing that resource. For example, prominent
        co-branding on the resource might lead a user to expect that
        multiple parties are responsible for the content or functionality.
      </p>
      <p>
        For any data collected as a result of one or more network
        interactions resulting from a user's action,
        a <dfn>third party</dfn> is any party other than that user, a first
        party for that user action, or a service provider acting on behalf
        of either that user or that first party.
      </p>
      <p>
        Access to Web resources often involves multiple parties that might
        process the data received in a network interaction. For example,
        domain name services, network access points, content distribution
        networks, load balancing services, security filters, cloud
        platforms, and software-as-a-service providers might be a party to a
        given network interaction because they are contracted by either the
        user or the resource owner to provide the mechanisms for
        communication. Likewise, additional parties might be engaged after a
        network interaction, such as when services or contractors are used
        to perform specialized data analysis or records retention.
      </p>
      <p>
        For the data received in a given network interaction, a
        <dfn>service provider</dfn> is considered to be the same party as
        its <dfn>contractee</dfn> if the service provider:
      </p>
      <ol>
        <li>processes the data on behalf of the contractee;</li>
        <li>ensures that the data is only retained, accessed, and used as
            directed by the contractee;</li>
        <li>has no independent right to use the data other than in a
            <a>permanently de-identified</a> form (e.g., for monitoring
            service integrity, load balancing, capacity planning, or
            billing); and,</li>
        <li>has a contract in place with the contractee which is consistent
            with the above limitations.</li>
      </ol>
    </section>

    <section id='terminology.data'>
      <h3>Data</h3>

      <p>
        A party <dfn>collects</dfn> data received in a network interaction
        if that data remains within the party’s control after the network
        interaction is complete.
      </p>
      <p>
        A party <dfn>uses</dfn> data if the party processes the data for any
        purpose other than storage or merely forwarding it to another party.
      </p>
      <p>
        A party <dfn>shares</dfn> data if it transfers or provides a copy of
        that data to any other party.
      </p>
      <p>
        Data is <dfn>permanently de-identified</dfn> when there exists a
        high level of confidence that no human subject of the data can be
        identified, directly or indirectly (e.g., via association with an
        identifier, user agent, or device), by that data alone or in
        combination with other retained or available information.
      </p>
    </section>

    <section id='terminology.preferences'>
      <h3>Preferences</h3>

      <p>
        A <dfn>user-granted exception</dfn> is a specific tracking
        preference, overriding a user's general tracking preference, that
        has been obtained and recorded using the mechanisms defined in
        <a href="#exceptions" class="sectionRef"></a>.
      </p>
    </section>
  </section>

  <section id='notational'>
    <h2>Notational Conventions</h2>

    <section id='requirements'>
      <h3>Requirements</h3>

      <p>The key words <em title="must" class="rfc2119">must</em>,
        <em title="must not" class="rfc2119">must not</em>,
        <em title="required" class="rfc2119">required</em>,
        <em title="should" class="rfc2119">should</em>,
        <em title="should not" class="rfc2119">should not</em>,
        <em title="recommended" class="rfc2119">recommended</em>,
        <em title="may" class="rfc2119">may</em>, and
        <em title="optional" class="rfc2119">optional</em> in this
        specification are to be interpreted as described in [[!RFC2119]].
      </p>
    </section>

    <section id='notation'>
      <h3>Formal Syntax</h3>

      <p>
        This specification uses the Augmented Backus-Naur Form (ABNF)
        notation of [[!RFC5234]] to define network protocol syntax and
        WebIDL [[!WEBIDL]] to define scripting APIs.
        Conformance criteria and considerations regarding error handling are
        defined in Section 2.5 of [RFC7230].
      </p>
    </section>
  </section>

  <section id='determining'>
    <h2>Determining User Preference</h2>

    <p>
      The goal of this protocol is to allow a user to express their
      personal preference regarding tracking to each server and
      web application that they communicate with via HTTP, thereby allowing
      recipients of that preference to adjust tracking behavior accordingly
      or to reach a separate agreement with the user that satisfies all
      parties.
    </p>
    <p>
      Key to that notion of expression is that the signal sent MUST reflect
      the user's preference, not the choice of some vendor, institution,
      site, or network-imposed mechanism outside the user's control;
      this applies equally to both the general preference and exceptions.
      The basic principle is that a tracking preference expression is only
      transmitted when it reflects a deliberate choice by the user. In the
      absence of user choice, there is no tracking preference expressed.
    </p>
    <p>
      A user agent MUST offer users a minimum of two alternative choices
      for a <q>Do Not Track</q> preference: <code><dfn>unset</dfn></code> or
      <code><dfn>DNT:1</dfn></code>.
      A user agent MAY offer a third alternative choice: <code><dfn>DNT:0</dfn></code>.
    </p>
    <p>
      If the user's choice is <a>DNT:1</a> or <a>DNT:0</a>, the
      tracking preference is <dfn>enabled</dfn>; otherwise, the
      tracking preference is <dfn>not enabled</dfn>.
    </p>
    <p>
      A user agent MUST have a default tracking preference of
      <code>unset</code> (not enabled) unless a specific tracking preference
      is implied by the user's decision to use that agent. For example, use
      of a general-purpose browser would not imply a tracking preference
      when invoked normally as <q>SuperFred</q>, but might imply a
      preference if invoked as <q>SuperDoNotTrack</q> or
      <q>UltraPrivacyFred</q>.
    </p>
    <p>
      Implementations of HTTP that are not under control of the user
      MUST NOT add, delete, or modify a tracking preference.
      Some controlled network environments, such as public access
      terminals or managed corporate intranets, might impose restrictions
      on the use or configuration of installed user agents, such that a
      user might only have access to user agents with a predetermined
      preference enabled.  However, if a user brings their
      own Web-enabled device to a library or cafe with wireless Internet
      access, the expectation will be that their chosen user agent and
      personal preferences regarding Web site behavior will not be
      altered by the network environment (aside from blanket limitations
      on what resources can or cannot be accessed through that network).
    </p>
    <p>
      An HTTP intermediary MUST NOT add, delete, or modify a tracking
      preference expression in a request forwarded through that intermediary
      unless the intermediary has been specifically installed or configured
      to do so by the user making the request. For example, an Internet
      Service Provider MUST NOT inject <a>DNT:1</a> on behalf
      of all users who have not expressed a preference.
    </p>
    <p>
      User agents often include user-installable <dfn>extensions</dfn>, also
      known as <dfn>add-ons</dfn> or <dfn>plug-ins</dfn>, that are
      capable of modifying configurations and making network requests. From
      the user's perspective, these extensions are considered part of the
      user agent and ought to respect the user's configuration of a tracking
      preference. The user agent as a whole is responsible for ensuring
      conformance with this protocol, to the extent possible, which means
      the user agent core and each extension are jointly responsible for
      conformance. However, there is no single standard for extension
      interfaces. A user agent that permits such extensions SHOULD provide
      an appropriate mechanism for extensions to determine the user's
      tracking preference.
    </p>
    <p>
      A user agent extension MUST NOT alter the tracking preference
      expression or its associated configuration unless the act of
      installing and enabling that extension is an explicit choice by the
      user for that tracking preference, or the extension itself complies
      with all of the requirements this protocol places on a user agent.
    </p>
    <p>
      Likewise, software outside of the user agent might filter network
      traffic or cause a user agent's configuration to be changed.
      Software that alters a user agent configuration MUST adhere to the
      above requirements on a user agent extension. Software that filters
      network traffic MUST adhere to the above requirements on an HTTP
      intermediary.
    </p>
    <p>
      Aside from the above requirements, we do not specify how the tracking
      preference choices are offered to the user or how the preference is
      enabled: each implementation is responsible for determining the user
      experience by which a tracking preference is <a>enabled</a>.
    </p>
    <p>
      For example, a user might select a check-box in their user agent's
      configuration, install an extension that is specifically
      designed to add a tracking preference expression,
      or make a choice for privacy that then implicitly includes a
      tracking preference (e.g., <q>Privacy settings: high</q>).
      A user agent might ask the user for their preference during startup,
      perhaps on first use or after an update adds the tracking protection
      feature. Likewise, a user might install or configure a proxy to add
      the expression to their own outgoing requests.
    </p>
  </section>

  <section id='expressing'>
    <h2>Expressing a Tracking Preference</h2>

    <section id='expression-format'>
      <h3>Expression Format</h3>
      <p>
        When a user has <a>enabled</a> a tracking preference, that
        preference needs to be expressed to all mechanisms that might
        perform or initiate <a>tracking</a>.
      </p>
      <p>
        When <a>enabled</a>, a tracking preference is expressed as either:
      </p>
      <table class="simple">
        <tr><th>DNT</th>
            <th>meaning</th>
        </tr>
        <tr><td>1</td>
            <td>This user prefers not to be tracked on the target site.</td>
        </tr>
        <tr><td>0</td>
            <td>This user prefers to allow tracking on the target site.</td>
        </tr>
      </table>
      <p>
        A user agent MUST NOT send a tracking preference expression if
        a tracking preference is <a>not enabled</a>.  This means that no
        expression is sent for each of the following cases:
      </p>
      <ul>
        <li>the user agent does not implement this protocol;</li>
        <li>the user has not yet made a choice for a specific preference;
            or,</li>
        <li>the user has chosen not to transmit a preference.</li>
      </ul>
      <p>
        In the absence of regulatory, legal, or other requirements, servers
        MAY interpret the lack of an expressed tracking preference as they
        find most appropriate for the given user, particularly when
        considered in light of the user's privacy expectations and cultural
        circumstances. Likewise, servers might make use of other preference
        information outside the scope of this protocol, such as
        site-specific user preferences or third-party registration services,
        to inform or adjust their behavior when no explicit preference is
        expressed via this protocol.
      </p>
    </section>

    <section id='dnt-header-field'>
      <h3>DNT Header Field for HTTP Requests</h3>

      <p>
        The <code><dfn>DNT</dfn></code> header field is a mechanism for expressing the
        user's tracking preference in an HTTP request ([[!RFC7230]]).
        At most one DNT header field can be present in a valid request.
      </p>
<pre class="abnf">
<dfn>DNT-field-name</dfn>  = "DNT"
<dfn>DNT-field-value</dfn> = ( "0" / "1" ) *DNT-extension
</pre>
      <p>
        A user agent MUST NOT generate a <a>DNT</a> header field if the
        user's tracking preference is <a>not enabled</a>.
      </p>
      <p>
        A user agent MUST generate a <a>DNT</a> header field with a
        field-value that begins with the numeric character "1" if the user's
        tracking preference is <a>enabled</a>, their preference is for
        <a>DNT:1</a>, and no exception has been granted for the
        request target (see <a href="#exceptions" class="sectionRef"></a>).
      </p>
      <p>
        A user agent MUST generate a <a>DNT</a> header field with a
        field-value that begins with the numeric character "0" if the user's
        tracking preference is <a>enabled</a> and their preference is for
        <a>DNT:0</a>, or if an exception has been granted for
        the request target.
      </p>
      <p>
        A proxy MUST NOT generate a <a>DNT</a> header field unless it has
        been specifically installed or configured to do so by the user
        making the request and adheres to the above requirements as if it
        were a user agent.
      </p>
<pre class="example">
GET /something/here HTTP/1.1
Host: example.com
DNT: 1

</pre>

      <section id='dnt-extensions'>
        <h4>DNT Extensions</h4>

        <p>
          The remainder of the DNT field-value, after the initial character,
          is reserved for future extensions. DNT extensions can only be
          transmitted when a tracking preference is <a>enabled</a>.
          The extension syntax is restricted to visible ASCII characters that
          can be parsed as a single word in HTTP and safely embedded in a
          JSON string without further encoding
          (<a href="#status-representation" class="sectionRef"></a>).
        </p>
<pre class="abnf">
<dfn>DNT-extension</dfn>   = %x21 / %x23-2B / %x2D-5B / %x5D-7E
                ; excludes CTL, SP, DQUOTE, comma, backslash
</pre>
        <p>
          For example, additional characters might indicate modifiers to the
          main preference expressed by the first digit, such that the main
          preference will be understood if the recipient does not understand
          the extension. Hence, a field-value of "1xyz" can be thought of
          as <q>do not track, but if you understand the refinements defined
          by x, y, or z, then adjust my preferences according to those
          refinements.</q>
        </p>
        <p>
          User agents that do not implement DNT extensions MUST NOT send
          DNT-extension characters in the DNT field-value.
          Servers that do not implement DNT extensions SHOULD ignore
          anything beyond the first character.
        </p>
        <p class="note">
          The DNT-extension feature is considered <em>at-risk</em>.
          Since no extensions have been defined, implementors that don't
          read specifications are likely to assume that DNT only has the
          fixed values of "0" or "1". Furthermore, the potential benefits
          of this mechanism are unclear given that extension information
          could be supplied using separate request header fields.
        </p>
      </section>
    </section>

    <section id='js-dom'>
      <h3>JavaScript Property to Detect Preference</h3>

      <p>
        The <code><dfn>Navigator.doNotTrack</dfn></code> property enables
        a client-side script with read access to the
        <code><dfn data-cite="!HTML5#navigator">Navigator</dfn></code> object
        [[!HTML5]] to determine what
        <a>DNT</a> header field value would be sent in requests to the
        document-origin, taking into account the user's general preference
        (if any) and the current user-granted exceptions applicable to that
        origin server.
      </p>
      <pre class="idl">
        partial interface Navigator {
            readonly attribute DOMString? doNotTrack;
        };
      </pre>
      <p>
          The value of <a>Navigator.doNotTrack</a> is the string value that
          would be sent in a <a>DNT-field-value</a>
          (<a href="#dnt-header-field" class="sectionRef"></a>) to a
          <strong>target</strong> that is the document-origin of the
          <code>window</code>, in the browser context of the current
          <strong>top-level origin</strong>.
          The value is <code>null</code> if no DNT header field would be
          sent (e.g., because a tracking preference is <a>not enabled</a>);
          otherwise, the value is a string beginning with "0" or "1",
          possibly followed by DNT-extension characters.
      </p>
    </section>

    <section id='other-protocols'>
      <h3>Tracking Preference Expressed in Other Protocols</h3>

      <p>
        A user's tracking preference is intended to apply in general,
        regardless of the protocols being used for Internet communication.
        However, it is beyond the scope of this specification to define how
        a user's tracking preference might be communicated via protocols
        other than HTTP.
      </p>
    </section>
  </section>

  <section id='responding'>
    <h2>Communicating a Tracking Status</h2>

    <section id='response-overview'>
      <h3>Overview</h3>

      <p>
        In addition to expressing the user's preference regarding tracking,
        this protocol enables servers to communicate machine-readable claims
        regarding their own tracking behavior. Since a personalized tracking
        status on every response would disable caching, a combination of
        response mechanisms are defined to allow the tracking status to be
        communicated prior to making a trackable request and without making
        every response dynamic.
      </p>
    </section>

    <section id='tracking-status-value'>
      <h3>Tracking Status Value</h3>

      <section id='TSV-defn'>
        <h4>Definition</h4>
        <p>
          A <dfn>tracking status value</dfn> (TSV) is a single character
          response to the user's tracking preference with regard to data
          collected via the <dfn>designated resource</dfn>.
          For a site-wide tracking status resource, the designated resource
          is any resource on the same origin server.
          For a <a>Tk</a> response header field, the target resource of the
          corresponding request is the designated resource, and remains so
          for any subsequent request-specific tracking status resource
          referred to by the Tk field value.
        </p>
        <p>
          The tracking status value is case sensitive, as defined formally
          by the following ABNF.
        </p>
<pre class="abnf">
<dfn>TSV</dfn>    = %x21   ; "!" — under construction
       / %x3F   ; "?" — dynamic
       / %x47   ; "G" — gateway to multiple parties
       / %x4E   ; "N" — not tracking
       / %x54   ; "T" — tracking
       / %x43   ; "C" — tracking with consent
       / %x50   ; "P" — tracking only if consented
       / %x44   ; "D" — disregarding DNT
       / %x55   ; "U" — updated
</pre>
      </section>

      <section id='TSV-!'>
        <h4>Under Construction (!)</h4>
        <p>
          A tracking status value of <code><dfn>!</dfn></code> means that the origin
          server is currently testing its communication of tracking status.
          The <code>!</code> value has been provided to ease testing and
          deployment on production systems during the initial periods of
          testing compliance and during adjustment periods due to future
          protocol changes or shifting regulatory constraints. Note that
          this value does not indicate that the user's preference will be
          ignored, nor that tracking will occur as a result of accessing
          the designated resource.
        </p>
      </section>

      <section id='TSV-?'>
        <h4>Dynamic (?)</h4>
        <p>
          A tracking status value of <code><dfn>?</dfn></code> means the origin server
          needs more information to determine tracking status, usually
          because the <a>designated resource</a> dynamically adjusts
          behavior based on information in a request.
        </p>
        <p>
          If <code>?</code> is present in the site-wide tracking status,
          the origin server MUST send a <a>Tk</a> header field in all
          responses to requests on the designated resource.
          If <code>?</code> is present in the <a>Tk</a> header field,
          more information will be provided in a request-specific
          tracking status resource referred to by the <a>status-id</a>.
          An origin server MUST NOT send <code>?</code> as the
          tracking status value in the representation of a
          request-specific tracking status resource.
        </p>
      </section>

      <section id='TSV-G'>
        <h4>Gateway (G)</h4>
        <p>
          A tracking status value of <code><dfn>G</dfn></code> means the server
          is acting as a gateway to an exchange involving multiple parties.
          This might occur if a response to the <a>designated resource</a>
          involves an automated selection process, such as dynamic bidding,
          where the party that is selected determines how the request data
          will be treated with respect to an expressed tracking preference.
          Similar to the <a>?</a> value, the <code>G</code> TSV
          indicates that the actual tracking status is dynamic and will be
          provided in the response message's <a>Tk</a> header field,
          presumably using information forwarded from the selected party.
        </p>
        <p>
          This tracking status value is only valid as a site-wide status.
          A server MUST NOT send <code>G</code> as the
          tracking status value in a <a>Tk</a> header field or within the
          representation of a request-specific tracking status resource.
        </p>
        <p>
          If <code>G</code> is present in the site-wide tracking status:
        </p>
        <ul>
          <li>the gateway MUST send a link within its site-wide
            tracking status representation to a privacy policy that
            explains what limitations are placed on parties that
            might receive data via that gateway;</li>
          <li>the gateway MUST forward any expressed tracking
            preference in the request to each party that receives data
            from that request;</li>
          <li>the gateway MUST have a contract in place with each of the
            parties to whom it provides request data such that only the
            selected party is allowed to retain tracking data from a
            request with an expressed tracking preference of
            <a>DNT:1</a>; and,</li>
          <li>the gateway MUST send a <a>Tk</a> header field in
            responses to requests on the designated resource and include
            within that field's value a <a>status-id</a>
            specific to the selected party, such that information about
            the selected party can be obtained via the request-specific
            tracking status resource (see
            <a href="#request-specific-status-resource" class="sectionRef"></a>).</li>
        </ul>
        <p>
          With respect to tracking performed by the gateway itself, the
          <code>G</code> response can be considered equivalent
          to the <a>T</a> (tracking) response defined below.
          The other information within the site-wide tracking status
          representation indicates how the gateway intends to comply
          with an expressed tracking preference, aside from the potential
          sharing of data implied by the gateway process.
        </p>
      </section>

      <section id='TSV-N'>
        <h4>Not Tracking (N)</h4>
        <p>
          A tracking status value of <code><dfn>N</dfn></code> means the origin server
          claims that data collected via the <a>designated resource</a> is
          not used for tracking and will not be combined with other data in
          a form that would enable tracking.
        </p>
      </section>

      <section id='TSV-T'>
        <h4>Tracking (T)</h4>
        <p>
          A tracking status value of <code><dfn>T</dfn></code> means the origin server
          might perform or enable tracking using data collected via the
          <a>designated resource</a>. Information provided in the tracking
          status representation might indicate whether such tracking is
          limited to a set of commonly accepted uses or adheres to one or
          more compliance regimes.
        </p>
      </section>

      <section id='TSV-C'>
        <h4>Consent (C)</h4>
        <p>
          A tracking status value of <code><dfn>C</dfn></code> means that the origin
          server believes it has received prior consent for tracking this
          user, user agent, or device, perhaps via some mechanism not
          defined by this specification, and that prior consent overrides
          the tracking preference expressed by this protocol.
          An origin server that sends the <code>C</code> tracking status
          value for a <a>designated resource</a> MUST provide a reference
          for controlling consent within the <a>config</a>
          property of its corresponding tracking status representation
          (<a href="#status-representation" class="sectionRef"></a>).
        </p>
      </section>

      <section id='TSV-P'>
        <h4>Potential Consent (P)</h4>
        <p>
          A tracking status value of <code><dfn>P</dfn></code> means that the origin
          server does not know, in real-time, whether it has received prior
          consent for tracking this user, user agent, or device, but
          promises not to use or share any <a>DNT:1</a> data
          until such consent has been determined, and further promises to
          delete or <a href="#dfn-permanently-de-identified">permanently de-identify</a>
          within forty-eight hours any <a>DNT:1</a> data
          received for which such consent has not been received.
        </p>
        <p>
          Since this status value does not itself indicate whether a
          specific request is tracked, an origin server that sends a
          <code>P</code> tracking status value MUST provide a
          <a>config</a> property in the corresponding tracking
          status representation that links to a resource for obtaining
          consent status.
        </p>
        <p>
          The <code>P</code> tracking status value is specifically meant to
          address audience survey systems for which determining consent at
          the time of a request is either impractical, due to legacy systems
          not being able to keep up with Web traffic, or potentially "gamed"
          by first party sites if they can determine which of their users
          have consented. The data cannot be used for the sake of
          personalization. If consent can be determined at the time of a
          request, the <a>C</a> tracking status is preferred.
        </p>
      </section>

      <section id='TSV-D'>
        <h4>Disregarding (D)</h4>
        <p>
          A tracking status value of <code><dfn>D</dfn></code> means that the origin
          server is unable or unwilling to respect a tracking preference
          received from the requesting user agent.  An origin server that
          sends the <code>D</code> tracking status value MUST detail within
          the server's corresponding privacy policy the conditions under
          which a tracking preference might be disregarded.
        </p>
        <p>
          For example, an origin server might disregard the DNT field
          received from specific user agents (or via specific network
          intermediaries) that are deemed to be non-conforming, might be
          collecting additional data from specific source network
          locations due to prior security incidents, or might be
          compelled to disregard certain DNT requests to comply with a
          local law, regulation, or order.
        </p>
        <p class="note">
          This specification is written with an assumption that the
          <code>D</code> tracking status value would only be used in
          situations that can be adequately described to users as an
          exception to normal behavior. If this turns out not to be the
          case, either the server's decision to send the <code>D</code>
          signal needs re-examination, or this specification, or both.
        </p>
      </section>

      <section id='TSV-U'>
        <h4>Updated (U)</h4>
        <p>
          A tracking status value of <code><dfn>U</dfn></code> means that the request
          resulted in a potential change to the tracking status applicable
          to this user, user agent, or device. A user agent that relies on a
          cached tracking status SHOULD update the cache entry with the
          current status by making a new request on the applicable tracking
          status resource.
        </p>
        <p>
          An origin server MUST NOT send <code>U</code> as a tracking status
          value anywhere other than a <a>Tk</a> header field that is in
          response to a state-changing request.
        </p>
      </section>
    </section>

    <section id='response-header-field'>
      <h3>Tk Header Field for HTTP Responses</h3>

      <section id='Tk-header-defn'>
        <h4>Definition</h4>

        <p>
          The <code><dfn>Tk</dfn></code> response header field is a means for indicating
          the tracking status that applied to the corresponding request.
          An origin server is REQUIRED to send a <code>Tk</code> header
          field if its site-wide tracking status value is <a>?</a>
          (dynamic) or <a>G</a> (gateway), or when an interactive change is
          made to the tracking status and indicated by <a>U</a> (updated).
        </p>
<pre class="abnf">
<dfn>Tk-field-name</dfn>   =  "Tk"
<dfn>Tk-field-value</dfn>  =  TSV [ ";" status-id ]
</pre>
        <p>
          The Tk field-value begins with a tracking status value
          (<a href="#tracking-status-value" class="sectionRef"></a>),
          optionally followed by a semicolon and a <code>status-id</code>
          that refers to a request-specific tracking status resource
          (<a href="#referring-status-id" class="sectionRef"></a>).
        </p>
        <p>
          For example, a Tk header field for a resource that claims not to
          be tracking would look like:
        </p>
        <pre class="example">Tk: N</pre>
      </section>

      <section id='referring-status-id'>
        <h4>Referring to a Request-specific Tracking Status Resource</h4>
        <p>
          If an origin server has multiple, request-specific tracking
          policies, such that the tracking status might differ depending on
          some aspect of the request (e.g., method, target URI, header
          fields, data, etc.), the origin server can provide an additional
          subtree of well-known resources corresponding to each of those
          distinct tracking statuses. The <code>status-id</code>
          portion of the <code>Tk</code> field-value indicates which specific
          tracking status resource applies to the current request.
          The <code>status-id</code> is case-sensitive.
        </p>
<pre class="abnf">
<dfn>status-id</dfn>       =  1*id-char
<dfn>id-char</dfn>         =  ALPHA / DIGIT / "_" / "-" / "+" / "=" / "/"
</pre>
        <p>
          For example, a response containing
        </p>
        <pre class="example">Tk: T;fRx42</pre>
        <p>
          indicates that data collected via the target resource might be
          used for tracking and that an applicable tracking status
          representation can be obtained by performing a retrieval request
          on
        </p>
        <pre>/.well-known/dnt/fRx42</pre>
        <p>
          Note that the <code>status-id</code> is resolved relative
          to the origin server of the current request.  A retrieval request
          targeting that URI can be redirected, if desired, to some other
          server.  The <code>status-id</code> has been intentionally limited
          to a small set of characters to encourage use of short tokens
          instead of potentially long, human-readable strings.
        </p>
        <p>
          If a Tk field-value has a tracking status value of
          <a>?</a> (dynamic), the origin server MUST
          send a <code>status-id</code> in the field-value.
        </p>
      </section>

      <section id='interactive-status-change'>
        <h4>Indicating an Interactive Status Change</h4>
        <p>
          Interactive mechanisms might be used, beyond
          the scope of this specification, that have the effect of asking
          for and obtaining prior consent for tracking, or for modifying
          prior indications of consent.  For example, the tracking status
          resource's status object defines a <a>config</a>
          property that can refer to such a mechanism. Although such
          out-of-band mechanisms are not defined by this specification,
          their presence might influence the tracking status object's
          response value.
        </p>
        <p>
          When an origin server provides a mechanism via HTTP for
          establishing or modifying out-of-band tracking preferences,
          the origin server MUST indicate within the mechanism's response
          when a state-changing request has resulted in a change to the
          tracking status for that server.  This indication of an
          interactive status change is accomplished by sending a
          <a>Tk</a> header field in the response with a tracking status
          value of <a>U</a> (updated).
        </p>
        <pre class="example">Tk: U</pre>
      </section>
    </section>

    <section id='status-resource'>
      <h3>Tracking Status Resource</h3>

      <section id='site-wide-status-resource'>
        <h4>Site-wide Tracking Status</h4>
        <p>
          A <dfn>site-wide tracking status resource</dfn> provides
          information about the potential tracking behavior of resources
          located at that origin server. A site-wide tracking status
          resource has the well-known identifier
        </p>
        <pre>/.well-known/dnt/</pre>
        <p>
          relative to the origin server's URI [[RFC5785]].
        </p>
        <p>
          An origin server that receives a valid <code>GET</code> request
          targeting its site-wide tracking status resource MUST send either
          a successful response containing a machine-readable representation
          of the site-wide tracking status, as defined below, or a sequence
          of redirects that leads to such a representation. Failure to
          provide access to such a representation implies that the target
          origin server does not implement this protocol.
          The representation can be cached, as described
          in <a href="#status-caching" class="sectionRef"></a>.
        </p>
        <p>
          See <a href="#using-tracking-status" class="sectionRef"></a> for
          examples of how tracking status resources can be used to discover
          support for this protocol.
        </p>
      </section>

      <section id='request-specific-status-resource'>
        <h4>Request-specific Tracking Status</h4>
        <p>
          If an origin server has multiple, request-specific tracking
          policies, such that the tracking status might differ depending on
          some aspect of the request (e.g., method, target URI, header
          fields, data, etc.), the origin server can provide an additional
          subtree of well-known resources corresponding to each of those
          distinct tracking statuses.  The <a>Tk</a> response header field
          (<a href="#response-header-field" class="sectionRef"></a>) can
          include a <a>status-id</a> to indicate which specific
          tracking status resource applies to the current request.
        </p>
        <p>
          A <dfn>tracking status resource space</dfn> is defined by the
          following URI Template [[RFC6570]]:
        </p>
        <pre>/.well-known/dnt/{+status-id}</pre>
        <p>
          where the value of <a>status-id</a> is a string of URI-safe
          characters provided by a <a>Tk</a> field-value in response to a
          prior request.  For example, a prior response containing
        </p>
        <pre class="example">Tk: ?;ahoy</pre>
        <p>
          refers to the specific tracking status resource
        </p>
        <pre>/.well-known/dnt/ahoy</pre>
        <p>
          Resources within the request-specific tracking status resource
          space are represented using the same format as a site-wide
          tracking status resource.
        </p>
      </section>

      <section id='status-checks-not-tracked'>
        <h4>Status Checks are Not Tracked</h4>
        <p>
          When sending a request for the tracking status, a user agent
          SHOULD include any cookie data [[RFC6265]] (set prior to the
          request) that would be sent in a normal request to that origin
          server, since that data might be needed by the server to determine
          the current tracking status. For example, the cookie data might
          indicate a prior out-of-band decision by the user to opt-out or
          consent to tracking by that origin server.
        </p>
        <p>
          An origin server MUST NOT retain tracking data regarding requests
          on the site-wide tracking status resource or within the tracking
          status resource space, regardless of the presence, absence, or
          value of a DNT header field, cookies, or any other information in
          the request.
          In addition, an origin server MUST NOT send Set-Cookie or
          Set-Cookie2 header fields in responses to those requests,
          including the responses to redirected tracking status requests,
          and MUST NOT send a response having content that initiates
          tracking beyond what was already present in the request.
          A user agent SHOULD ignore, or treat as an error, any Set-Cookie
          or Set-Cookie2 header field received in such a response.
        </p>
      </section>

      <section id='status-caching'>
        <h4>Caching</h4>
        <p>
          If the tracking status is applicable to all users, regardless of
          the received <a>DNT-field-value</a> or other data received via the
          request, then the origin server SHOULD mark the response as
          cacheable [[!RFC7234]] and assign a time-to-live (expiration or
          max-use) that is sufficient to enable shared caching but not
          greater than the earliest point at which the service's tracking
          behavior might increase.
        </p>
        <p>
          For example, if the tracking status response is set to expire in
          seven days, then the earliest point in time that the service's
          tracking behavior can be increased is seven days after the
          tracking status representation has been
          updated to reflect the new behavior, since old copies might
          persist in caches until the expiration is triggered. A service's
          tracking behavior can be reduced at any time, with or without a
          corresponding change to the tracking status resource.
        </p>
        <p>
          If the tracking status is only applicable to users that have
          the same <a>DNT-field-value</a>, the origin server MUST send a
          Vary header field that includes "DNT" in its field-value or a
          Cache-Control header field containing one of the following
          directives: "private", "no-cache", "no-store", or "max-age=0".
        </p>
        <p>
          If the tracking status is only applicable to the specific user
          that requested it, then the origin server MUST send a
          Cache-Control header field containing one of the following
          directives: "private", "no-cache", or "no-store".
        </p>
        <p>
          Regardless of the cache-control settings, it is expected that
          user agents will check the tracking status of a service only once
          per session (at most).  A public Internet site that intends to
          change its tracking status to increase tracking behavior MUST
          update the tracking status resource in accordance with that
          planned behavior at least twenty-four hours prior to activating
          that new behavior on the service.
        </p>
        <p>
          A user agent that adjusts behavior based on active verification
          of tracking status, relying on cached tracking status responses
          to do so, SHOULD check responses to its state-changing requests
          (e.g., POST, PUT, DELETE, etc.) for a <a>Tk</a> header field
          with the <a>U</a> tracking status value, as described in
          <a href="#interactive-status-change" class="sectionRef"></a>.
        </p>
      </section>
    </section>

    <section id='status-representation'>
      <h3>Tracking Status Representation</h3>
      <p>
        For each tracking status resource, an origin server MUST provide a
        valid representation using the
        <code><dfn>application/tracking-status+json</dfn></code> media type.
        This media type consists of a <a>status object</a>
        serialized as JSON [[!RFC7159]]. More information about the
        <code>application/tracking-status+json</code> media type can be
        found in <a href="#registrations" class="sectionRef"></a>.
      </p>

      <section id='rep.status-object'>
        <h4>Status Object</h4>
        <p>
          A tracking status representation consists of a single
          <dfn>status object</dfn> containing properties that
          describe the tracking status applicable to the
          <a>designated resource</a>.  Most of the properties are optional
          and can be extended over time, as illustrated by the following
          Orderly schema [[Orderly]]:
        </p>
<pre class="orderly">
object {
    string tracking;                 // TSV
    array { string; } compliance?;   // hrefs
    string qualifiers?;              // compliance flags
    array { string; } controller?;   // hrefs
    array { string; } same-party?;   // domains
    array { string; } audit?;        // hrefs
    string policy?;                  // href
    string config?;                  // href
}*;
</pre>

	<p>
          The following example representation demonstrates a status object
          with all of the properties defined by this specification.
        </p>
<pre class="example">
{
  "tracking": "T",
  "compliance": ["https://acme.example.org/tracking101"],
  "qualifiers": "afc",
  "controller": ["https://www.example.com/privacy"],
  "same-party": [
    "example.com",
    "example_vids.net",
    "example_stats.com"
  ],
  "audit": [
    "http://auditor.example.org/727073"
  ],
  "policy": "/privacy.html#tracking",
  "config": "http://example.com/your/data"
}
</pre>
      </section>

      <section id='rep.tracking'>
        <h4>Tracking Property</h4>
        <p>
          A <a>status object</a> MUST have a property named
          <code>tracking</code> with a string value containing
          the tracking status value
          (<a href="#tracking-status-value" class="sectionRef"></a>)
          applicable to the <a>designated resource</a>.
        </p>
        <p>
          For example, the following demonstrates a minimal tracking status
          representation that is applicable to any resource that does not
          perform tracking.
        </p>
<pre class="example">
{"tracking": "N"}
</pre>
      </section>

      <section id='rep.compliance'>
        <h4>Compliance Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>compliance</dfn></code> with an array value containing
          a list of URI references that identify specific regimes to which
          the origin server claims to comply for the designated resource.
          Communicating such a claim of compliance is presumed to improve
          transparency, which might influence a user's decisions or
          configurations regarding allowed tracking, but does not have any
          direct impact on this protocol.
        </p>
      </section>

      <section id='rep.qualifiers'>
        <h4>Qualifiers Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>qualifiers</dfn></code> with a string value
          containing a sequence of case sensitive characters corresponding
          to explanations or limitations on the extent of tracking.
          Multiple qualifiers indicate that multiple explanations or forms
          of tracking might apply for the designated resource.
          The meaning of each qualifier is presumed to be defined by one
          or more of the regimes listed in <a>compliance</a>.
        </p>
      </section>

      <section id='rep.controller'>
        <h4>Controller Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>controller</dfn></code> with an array value containing
          a list of URI references indirectly identifying the party or
          set of parties that claims to be the responsible data controller
          for personal data collected via the designated resource. An origin
          server MUST send a <code>controller</code> property if the
          responsible data controller does not own the designated resource's
          domain name.
        </p>
        <p>
          An origin server that does not send <code>controller</code>
          is implying that its domain owner is the sole data controller;
          information about the data controller ought to be found on the
          designated resource's site root page, or by way of a clearly
          indicated link from that page (i.e., an absent controller property
          is equivalent to: <code>"controller":["/"]</code>).
        </p>
        <p>
          If the <a>designated resource</a> has joint data controllers
          (i.e., multiple parties have independent control over the
          collected data), the origin server MUST send a
          <code>controller</code> property that contains a reference
          for each data controller.
        </p>
        <p>
          Each URI reference provided in <code>controller</code> ought to
          refer to a resource that, if a retrieval action is performed on
          that URI, would provide the user with information regarding (at a
          minimum) the identity of the corresponding party and its data
          collection practices.
        </p>
      </section>

      <section id='rep.same-party'>
        <h4>Same-party Property</h4>
        <p>
          Since a user's experience on a given site might be composed of
          resources that are assembled from multiple domains, it might be
          useful for a site to distinguish those domains that are subject to
          their own control (i.e., share the same data controller as the
          referring site).
          An origin server MAY send a property named
          <code><dfn>same-party</dfn></code> with an array value containing
          a list of domain names that the origin server claims are the same
          party, to the extent they are referenced by the designated
          resource, if all data collected via those references share the
          same data controller as the designated resource.
        </p>
        <p>
          A user agent might use the <code>same-party</code> array,
          when provided, to inform or enable different behavior for
          references that are claimed to be same-party versus those for
          which no claim is made. For example, a user agent might choose to
          exclude, or perform additional pre-flight verification of,
          requests to other domains that have not been claimed as same-party
          by the referring site.
        </p>
      </section>

      <section id='rep.audit'>
        <h4>Audit Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>audit</dfn></code> with an array value containing a
          list of URI references to external audits of the designated
          resource's privacy policy and tracking behavior.
          Preferably, the audit references are to resources that describe
          the auditor and the results of that audit; however, if such a
          resource is not available, a reference to the auditor is
          sufficient.
        </p>
      </section>

      <section id='rep.policy'>
        <h4>Policy Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>policy</dfn></code> with a string value containing a
          URI reference to a human-readable document that describes the
          relevant privacy policy for the designated resource.
          The content of such a policy document is beyond the
          scope of this protocol and only supplemental to what is described
          in the machine-readable tracking status representation.
          If no <code>policy</code> property is provided, this
          information might be obtained via the links provided in
          <a>controller</a>.
        </p>
      </section>

      <section id='rep.config'>
        <h4>Config Property</h4>
        <p>
          An origin server MAY send a property named
          <code><dfn>config</dfn></code> with a string value containing a
          URI reference to a resource for giving the user control over
          personal data collected via the designated resource (and possibly
          other resources).
          If the tracking status value indicates prior consent
          (<a>C</a>), the origin server MUST send a
          <code>config</code> property referencing a resource that
          describes how such consent is established and how to revoke that
          consent.
        </p>
        <p>
          A config resource might include the ability to review
          past data collected, delete some or all of the data, provide
          additional data (if desired), or <q>opt-in</q>, <q>opt-out</q>,
          or otherwise modify an out-of-band consent status regarding
          data collection. The design of such a resource,
          the extent to which it can provide access to that data, and
          how one might implement an out-of-band consent mechanism are
          beyond the scope of this protocol.
        </p>
        <p>
          If no <code>config</code> property is provided, this
          information might be obtained via the links provided in
          <a>controller</a> or <a>policy</a>.
        </p>
      </section>

      <section id='rep.extension'>
        <h4>Extensions</h4>
        <p> An origin server MAY send additional properties in the <a>status object</a> or define additional tracking status values to support future enhancements to this protocol. 
        <p> We require that extensions introduced SHOULD be defined and described by a document referenced by a URL in the compliance array property. A recipient MUST ignore extension properties that it does not recognize.
        </p>

        <p class="note">
One goal of this extensibility is to enable variations by policy and the evolution of best practices for the emerging EU regulations.
	</p>

      </section>
    </section>

    <section id='response-error'>
      <h3>Status Code for Tracking Required</h3>

      <p>
        If an origin server receives a request with <a>DNT:1</a>,
        does not have out-of-band consent for tracking this user, and
        wishes to deny access to the requested resource until the user
        provides some form of user-granted exception or consent for tracking,
        then the origin server SHOULD send a 409 (Conflict) response with a
        message payload that describes why the request has been refused and
        how one might supply the required consent or exception to avoid this
        conflict [[!RFC7231]].
      </p>
      <p>
        The 409 response ought to include a user authentication mechanism in
        the header fields and/or message body if user login is one of the
        ways through which access is granted.
      </p>
    </section>

    <section id='using-tracking-status'>
      <h3>Using the Tracking Status</h3>

      <p class="note">
        This section is for collecting use cases that describe questions a
        user agent might have about tracking status and how the protocol
        can be used to answer such questions.  More cases are needed.
      </p>

      <section id='using-deployment'>
        <h4>Discovering Deployment</h4>
        <p>
          Deployment of this protocol for a given service can
          be discovered by making a retrieval request on the site-wide
          tracking resource <q><code>/.well-known/dnt/</code></q> relative
          to the service URI.
        </p>
        <p>
          If the response is an error, then the service does not implement
          this standard. If the response is a redirect, then follow the
          redirect to obtain the tracking status (up to some reasonable
          maximum of redirects to avoid misconfigured infinite request
          loops). If the response is successful, obtain the tracking status
          representation from the message payload, if possible, or consider
          it an error.
        </p>
      </section>

      <section id='using-preflight'>
        <h4>Preflight Checks</h4>
        <p>
          A key advantage of providing the tracking status at a resource
          separate from the site's normal services is that the status can
          be accessed and reviewed prior to making use of those services.
        </p>
        <p>
          A user agent MAY check the tracking status for a
          <a>designated resource</a> by first making a retrieval request for
          the site-wide tracking status representation, as described above,
          and then parsing the representation as JSON to extract the
          <a>status object</a>.
          If the retrieval is unsuccessful or parsing results in a syntax
          error, the user agent ought to consider the site to be
          non-conformant with this protocol.
        </p>
        <p>
          The <a>status object</a> is supposed to have a
          property named <code>tracking</code> containing the tracking
          status value. The meaning of each tracking status value is defined
          in <a href="#tracking-status-value" class="sectionRef"></a>.
        </p>
        <p>
          If the tracking status value is <a>N</a>, then the origin server
          claims that no tracking is performed for the designated resource
          for at least the next 24 hours or until the Cache-Control
          information indicates that this response expires.
        </p>
        <p>
          If the tracking status value is not <a>N</a>, then the origin
          server claims that it might track the user agent for requests on
          the URI being checked for at least the next 24 hours or until the
          Cache-Control information indicates that this response expires.
        </p>
      </section>
    </section>
  </section>

  <section id='exceptions' >
    <h2>User-Granted Exceptions</h2>

    <section id="exceptions-overview" class="informative">
      <h3>Overview</h3>

      <p>
        User-granted exceptions to Do Not Track, including site-specific
        exceptions, are agreed between the site and the user, and stored by
        the user agent. A resource ought to rely on the DNT header field it
        receives to determine the user's preference for tracking with
        respect to that particular request. An API is provided so that sites
        can request and check the status of exceptions for tracking.
      </p>
      <p class="note">We envisage that the exceptions might also be usable as 
        a consent mechanism.
      </p>
    </section>

    <section id="exceptions-principles" class="informative">
      <h3>Motivating Principles and Use Cases</h3>

      <p>
        The following principles guide the design of user-agent-managed
        exceptions.
      </p>
      <ul>
        <li>Content providers might wish to prompt visitors to their
          properties to <q>opt back in</q> to tracking for behavioral
          advertising or similar purposes when they arrive with the Do Not
          Track setting enabled.</li>
        <li>Privacy-conscious users might wish to view or edit all the
          exceptions they've granted in a single, consistent user interface,
          rather than managing preferences in a different way on every
          content provider or tracker's privacy page.</li>
        <li>Granting an exception in one context (e.g., while browsing a news
          site) does not imply that exception is applicable to other contexts
          (e.g., browsing an unrelated medical site).</li>
        <li>Tracking providers ought to be able to avoid second-guessing a
          user's expressed tracking preference.</li>
        <li>The solution need not require cross-domain communication
          between a first-party publisher and its third parties.</li>
      </ul>
      <p>
        When asking for a site-specific exception, the top-level origin
        making the request might make some implicit or explicit claims as
        to the actions and behavior of its third parties; for this reason,
        it might want to establish exceptions for only those for which it is
        sure that those claims are true. (Consider a site that has some
        trusted advertisers and analytics providers, along with some mashed-up
        content from less-trusted sites). For this reason, there is support
        both for explicitly named sites, as well as support for granting an
        exception to all third-parties on a given site (site-wide exception,
        using the conceptual wild-card "*").
      </p>
      <p>
        There are some cases in which a user might desire a site to be allowed
        to track them on any top-level origin. An API is provided so that
        a site might obtain such a web-wide exception from the user.
      </p>
    </section>

    <section id='exception-model'>
      <h3>Exception Model</h3>

      <section>
        <h4>User Interaction</h4>
        <p>
          The call to store an exception MUST reflect the user's intention
          to grant an exception at the time of that call. This intention
          MUST be determined by the site prior to each call to store an
          exception, at the time of the call. (This allows a user to
          change their mind and delete a stored exception, which might result
          in the site explaining and asking for the exception again.)
          It is the sole responsibility of the site making the call to
          determine that a call to record an exception reflects the user's
          informed consent at the time of that call.
        </p>
        <p>
          A Tracking Exception MUST only be requested when the document origin
          requesting it has a valid Tracking Status Resource at the well-known
          location, from which information about the domain’s controlling
          entity(s) and their privacy policy can be ascertained.
        </p>
        <p>
          To be valid the response to a retrieval request on the site-wide tracking
          resource "<code>/.well-known/dnt/</code>" relative to the service URI, must have a
          <code>application/tracking-status+json</code> media type,
          be valid JSON, and include at least the <code>tracking</code>, <code>controller</code>, <code>compliance</code>
          and <code>policy</code> properties.
        </p>
        <p>
          A user agent MAY also refuse to grant a Site-Speciifc Tracking Exception for a named
          <strong>target</strong> domain (see <strong>Processing Model</strong> below) which does not have a valid Tracking
          Status Resource at its well-known location.
        </p>
        <p>
          A site MAY ask for an exception, and have it stored, even when the
          user's general preference is not <a>enabled</a>. (This permits
          recording a permission to allow tracking in jurisdictions where
          such permission cannot be assumed – see
          <a href="#exceptions-no-js" class="sectionRef"></a>.)
        </p>
        <p>
          The user agent MAY provide interfaces to the user:
        </p>
        <ul>
          <li>To indicate that a call to store an exception has just been
            made;</li>
          <li>To allow the user to confirm a user-granted exception prior
            to storage;</li>
          <li>To indicate that one or more exceptions exist for the
            current top-level origin;</li>
          <li>To indicate that one or more exceptions exist for sites
            incorporated into the current page;</li>
          <li>To allow the user to see and possibly revoke stored
            exceptions;</li>
          <li>Other aspects of the exception mechanism, as desired.</li>
        </ul>
        <p>
          There is no required user interface for the user agent; 
          a user agent MAY choose to provide no user interface regarding 
          user-granted exceptions.
        </p>
        <p>
          If the user revokes the consent by deleting the exception, the
          site MUST respect that revocation (though it MAY ask again for
          the exception). The site MUST NOT use this exception mechanism if it
          will deem consent to exist even after the exception has been
          revoked.
        </p>
      </section>

      <section>
        <h4>Processing Model</h4>
        <p>
          This section describes the effect of the APIs in terms of a
          logical processing model; this model describes the behavior, but
          is not to be read as mandating any specific implementation.
        </p>
        <p>
          This API considers exceptions which are double-keyed to two
          domains: the <strong>site</strong>, and the
          <strong>target</strong>. A user might &#8212; for instance &#8212;
          want AnalytiCo to be allowed to track them on Example News, but
          not on Example Medical. To simplify language used in this API
          specification, we define three terms:
        </p>
        <ul>
          <li>A <strong>top-level origin</strong> is the <strong>top-level
            browsing context</strong>, as defined by [[!HTML5]];</li>
          <li>A <strong>target</strong> site is the host subcomponent of the
            authority part in an "http" or "https" URI, as defined by
            [[!RFC7230]] and [[!RFC3986]]; and,</li>
          <li>The <strong>document origin</strong> of a script is the
            <strong>effective script origin</strong>, as defined by
            [[!HTML5]].</li>
        </ul>
        <p>
           For instance, if the document at
           <code>http://web.exnews.com/news/story/2098373.html</code>
           references the resources
           <code>http://exnews.analytico.net/1x1.gif</code> and
           <code>http://widgets.exsocial.org/good-job-button.js</code>,
           <strong>the top-level origin</strong> is <code>web.exnews.com</code>;
           <code>exnews.analytico.net</code> and
           <code>widgets.exsocial.org</code> are both
           <strong>targets</strong>.
        </p>
        <p>
          The domains that enter into the behavior of the APIs include:
        </p>
        <ul>
          <li>As described above, the <strong>document origin</strong>
            active at the time of the call, and;</li>
          <li>Domain names passed to the API.</li>
        </ul>
        <p>
          Domains that enter into the decision over what DNT header field to
          be sent in a given request include:
        </p>
        <ul>
          <li>The <strong>top-level origin</strong> of the current browser
            context;</li>
          <li>The <strong>target</strong> of the request.</li>
        </ul>
        <p class="note">
          Note that these strict, machine-discoverable concepts might not
          match the definitions of first and third party; in particular,
          sites themselves need to determine when they are a first party in
          relation to a given user action; the user agent does not change the
          DNT header field based on the type of network interaction.
        </p>
        <p>
          The calls cause the following steps to occur (subject to user 
          confirmation of the exception, if the user agent asks for it):
        </p>
        <ul>
          <li>The user agent adds to its local database one or more site-pair
            duplets [document-origin, target]; one or the other of these MAY
            be a wild-card ("*");</li>
          <li>While the user is browsing a given site (top-level origin),
            and a DNT header field is to be sent to a target domain, if the
            duplet [top-level origin, target domain] matches any duplet in the
            database, then a <a>DNT:0</a> preference is sent,
            otherwise the user’s general preference is sent (if any).</li>
        </ul>
        <p>
          A pair of duplets [A,B] and [X,Y] match if A matches X and B matches Y. 
          A pair of values A and X match if and only if one of the following 
          is true:
        </p>
        <ul>
          <li>either A or X is "*";</li>
          <li>A and X are the same string;</li>
          <li>A has the form '*.domain' and X is 'domain' or is of the form
            'string.domain', where 'string' is any sequence of characters.</li>
        </ul>
        <p>
          In addition, responses to the JavaScript API indicated should be
          consistent with this user preference (see below).
        </p>
        <p>
          User-agents MUST handle each API request as a 'unit', granting and
          maintaining it in its entirety, or not at all. That means that a
          user agent MUST NOT indicate to a site that a request for targets
          {a, b, c} exists in the database, and later remove only one or two
          of {a, b, c} from its logical database of remembered grants. This
          assures sites that the set of sites they need for operational
          integrity is treated as a unit. Each separate call to an API is a
          separate unit.
        </p>
        <p>
          It is left up to individual user agent implementations how to
          determine and how and whether to store users' tracking
          preferences.
        </p>
        <p>
          When an explicit list of domains is provided through the API,
          their names might mean little to the user. The user might, for
          example, be told that there is a stored exception for a specific
          set of sites on such-and-such top-level origin, rather than
          listing them by name; or the user agent might decide to store a
          site-wide exception, effectively ignoring any list of domain names.
        </p>
        <p>
          Conversely, if a wild-card is used, the user might be told that
          there is a stored exception for all third-parties that are embedded
          by the indicated top-level origin.
        </p>
      </section>
    </section>

    <section id="exceptions-javascript-api">
      <h3>Site-specific Exceptions</h3>
      
      <section id="exceptions-javascript-api-rqst">
        <h4>API to Request a Site-specific Exception</h4>

        <p>
          <code><dfn>Navigator.storeSiteSpecificTrackingException</dfn></code>
          is called by a page to store a site-specific tracking exception.
          A <code><dfn>StoreExceptionPropertyBag</dfn></code> dictionary
          contains the information to be stored for that exception.
	  It returns a <code>Promise</code> resolving to a <code><dfn>StoreExceptionResult</dfn></code> result object.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
            Promise&lt;StoreExceptionResult&gt; storeSiteSpecificTrackingException ( 
            StoreExceptionPropertyBag properties
            );
        };
        
        dictionary StoreExceptionPropertyBag {
           DOMString? domain;
           DOMString? siteName;
           DOMString? explanationString;
           DOMString? detailURI;
           DOMString? expires;
           long?      maxAge;
           sequence&lt;DOMString&gt; arrayOfDomainStrings;
        };
        
        dictionary StoreExceptionResult {
          boolean siteWide;
        };
        </pre>
        <p>
          <a>Navigator.storeSiteSpecificTrackingException</a> passes a
          <a>StoreExceptionPropertyBag</a> that can contain the following
          properties:
        </p>
        <dl data-dfn-for="StoreExceptionPropertyBag">
          <dt><code><dfn>domain</dfn></code></dt>
          <dd>a cookie-domain as defined in [[!RFC6265]],
              to which the exception applies.</dd>
          <dt><code><dfn>siteName</dfn></code></dt>
          <dd>A user-readable string for the name of the top-level origin.</dd>
          <dt><code><dfn>explanationString</dfn></code></dt>
          <dd>A short explanation of the request.</dd>
          <dt><code><dfn>detailURI</dfn></code></dt>
          <dd>A location at which further information about this request
              can be found.</dd>
          <dt><code><dfn>expires</dfn></code></dt>
          <dd>A date and time, encoded as described for the cookie
              <code>Expires</code> attribute described in [[RFC6265]],
              indicating the maximum lifetime of the remembered grant.</dd>
          <dt><code><dfn>maxAge</dfn></code></dt>
          <dd>A positive number of seconds indicating the maximum lifetime
              of the remembered grant.</dd>
          <dt><code><dfn>arrayOfDomainStrings</dfn></code></dt>
          <dd>A JavaScript array of strings.</dd>
        </dl>
        <p>
          Calling <code>storeSiteSpecificTrackingException</code> returns a <code>Promise</code> 
          which either resolves to a <code>StoreExceptionResult</code> object, or is rejected with 
          a <code>DOMException</code> SYNTAX_ERR result. The <code>Promise</code> resolves 
          immediately the Tracking Exception request has been processed, with the property <code>siteWide</code>
          in the result object set <code>true</code> if the Exception is site-wide.
        </p>
        <p>
          If the request does not include the
          <code>arrayOfDomainStrings</code>, then this request is for a
          site-wide exception. Otherwise each string in
          <code>arrayOfDomainStrings</code> specifies a
          <strong>target</strong>.
        </p>
        <p>
          If the list <code>arrayOfDomainStrings</code> is supplied, the
          user agent MAY choose to store a site-wide exception. If it does
          so it MUST indicate this by setting the <code>siteWide</code> property to <code>true</code>.
        </p>
        <p>
          If <code>domain</code> is not specified or is null or empty then
          the execution of this API and the use of the resulting permission
          (if granted) use the 'implicit' parameter, when the API is called,
          the <strong>document origin</strong>. This forms the first part of
          the duplet in the logical model, and hence in operation will be
          compared with the <strong>top-level origin</strong>.
        </p>
        <p>
          If permission is stored for an explicit list, then the set of
          duplets (one per target):
        </p>
        <pre>[document-origin, target]</pre>
        <p>
          is added to the database of remembered grants.
        </p>
        <p>
          If permission is stored for a site-wide exception, then the
          duplet:
        </p>
        <pre>[document-origin, * ]</pre>
        <p>
          is added to the database of remembered grants.
        </p>
        <p>
          If <code>domain</code> is supplied and not empty then it is
          treated in the same way as the domain parameter to cookies and
          allows setting for subdomains. The <code>domain</code> argument
          can be set to fully-qualified right-hand segment of the document
          host name, up to one level below TLD.
        </p>
        <p>
          For example, <em>www.foo.bar.example.com</em> can set the domain
          parameter as as <code>"bar.example.com"</code> or
          <code>"example.com"</code>, but not to
          <code>"something.else.example.com"</code> or <code>"com"</code>.
        </p>
        <p>
          If the document-origin would not be able to set a cookie on the
          <code>domain</code> following the cookie domain rules [[!RFC6265]]
          (e.g. <code>domain</code> is not a right-hand match or is a TLD)
          then the duplet MUST NOT be entered into the database and the
          returned <code>Promise</code>
          rejected with a <code>DOMException</code> SYNTAX_ERR.
        </p>
        <p>
          If permission is stored for an explicit list, then the set of
          duplets (one per target):
        </p>
        <pre>[*.domain, target]</pre>
        <p>
          is added to the database of remembered grants.
        </p>
        <p>
          If permission is stored for a site-wide exception, then the
          duplet:
        </p>
        <pre>[*.domain, * ]</pre>
        <p>
          is added to the database of remembered grants.
        </p>
        <p>
          A particular response to the API &mdash; like a DNT response header
          field &mdash; is only valid immediately; a user might later choose
          to edit stored exceptions and revoke some or all of them.
        </p>
        <p>
          If <code>expires</code> is supplied and not null or empty the
          remembered grant will be cancelled (i.e. processed as if the
          relevant Cancel API had been called) no later than the specified
          date and time. After this the database of remembered grants will
          no longer contain any duplets for which the first part is the
          current document origin; i.e., no duplets
          <code>[document-origin, target]</code> for any target.
        </p>
        <p>
          If <code>maxAge</code> is supplied and not null, empty or negative
          the remembered grant will be cancelled (i.e. processed as if the
          relevant Cancel API had been called) no later than the specified
          number of seconds following the grant.
        </p>
        <p>
          If both <code>maxAge</code> and <code>expires</code> are supplied,
          <code>maxAge</code> has precedence. If neither <code>maxAge</code>
          or <code>expires</code> are supplied, the user agent MAY retain
          the remembered grant until it is cancelled.
        </p>
      </section>

      <section id="exceptions-javascript-api-cancel">
        <h4>API to Cancel a Site-specific Exception</h4>

        <p>
          <code><dfn>Navigator.removeSiteSpecificTrackingException</dfn></code>
          is called by a page to cancel a site-specific tracking exception.
          A <code><dfn>RemoveExceptionPropertyBag</dfn></code> dictionary
          contains information to identify the exception.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
          Promise&lt;void&gt; removeSiteSpecificTrackingException (
            RemoveExceptionPropertyBag properties
          );
        };

        dictionary RemoveExceptionPropertyBag {
          DOMString? domain;
        };
        </pre>
        <p>
          <a>Navigator.removeSiteSpecificTrackingException</a> passes a
          <a>RemoveExceptionPropertyBag</a> that can contain the following
          property:
        </p>
        <dl data-dfn-for="RemoveExceptionPropertyBag">
          <dt><code><dfn>domain</dfn></code></dt>
          <dd>a cookie-domain as defined in [[!RFC6265]],
              to which the exception applies.</dd>
        </dl>
        <p>
          If domain is not supplied or is null or empty then this
          ensures that the database of remembered grants no longer
          contains any duplets for which the first part is the current
          document origin; i.e., no duplets
          <code>[document-origin, target]</code> for any target.
        </p>
        <p>
          If domain is supplied and is not empty then this ensures that
          the database of remembered grants no longer contains any
          duplets for which the first part is the domain wildcard; i.e.,
          no duplets <code>[*.domain, target]</code> for any target.
        </p>
        <p>
          A <code>Promise</code> resolving to <code>void</code> is returned.
          When the <code>Promise</code> has been resolved, it is assumed
          that there are no site-specific or site-wide exceptions for the given top-level origin.
        </p>
        <p>
          When the returned <code>Promise</code> is resolved, the database of grants no longer
          contains the indicated grant(s); if some kind of processing error
          occurred then an appropriate exception will be thrown.
        </p>
        <p>
          If there are no matching duplets in the database of remembered
          grants when the method is called then this operation does nothing
          (and does not throw an exception).
        </p>
      </section>
      
      <section id="exceptions-javascript-api-confirm">
        <h4>API to Confirm a Site-specific Exception</h4>

        <p>
          <code><dfn>Navigator.confirmSiteSpecificTrackingException</dfn></code>
          is called by a page to confirm a site-specific tracking exception.
          A <code><dfn>ConfirmExceptionPropertyBag</dfn></code> dictionary
          contains information to identify the exception.
          It returns a <code>Promise</code> resolving to a <code><dfn>ConfirmExceptionResult</dfn></code>
	  result object.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
          Promise&lt;ConfirmExceptionResult&gt; confirmSiteSpecificTrackingException (
            ConfirmExceptionPropertyBag properties
          );
        };

        dictionary ConfirmExceptionPropertyBag {
          DOMString? domain;
          sequence&lt;DOMString&gt; arrayOfDomainStrings;
        };
	
        dictionary ConfirmExceptionResult {
          boolean exists;
        };	
        </pre>
        <p>
          <a>Navigator.confirmSiteSpecificTrackingException</a> passes a
          <a>ConfirmExceptionPropertyBag</a> that can contain the following
          properties:
        </p>
        <dl data-dfn-for="ConfirmExceptionPropertyBag">
          <dt><code><dfn>domain</dfn></code></dt>
          <dd>a cookie-domain as defined in [[!RFC6265]],
              to which the exception applies.</dd>
          <dt><code><dfn>arrayOfDomainStrings</dfn></code></dt>
          <dd>A JavaScript array of strings.</dd>
        </dl>
        <p>
          If the call does not include the
          <code>arrayOfDomainStrings</code>, then this call is to confirm a
          site-wide exception. Otherwise each string in
          <code>arrayOfDomainStrings</code> specifies a
          <strong>target</strong>.
        </p>
        <p>
          If the list <code>arrayOfDomainStrings</code> is supplied, and the
          user agent stores only site-wide exceptions, then the user agent
          MUST match by confirming a site-wide exception.
        </p>
        <p>
          If the <code>domain</code> argument is not supplied or is null or
          empty then the execution of this API uses the 'implicit'
          parameter, when the API is called, the
          <strong>document origin</strong>. This forms the first part of the
          duplet in the logical model.
        </p>
        <p>
          If the user agent stores explicit lists, and the call includes
          one, the database is checked for the existence of all the duplets
          (one per target):
        </p>
        <pre>[document-origin, target]</pre>
        <p>
          If the user agent stores only site-wide exceptions or the call did
          not include an explicit list, the database is checked for the 
          single duplet:
        </p>
        <pre>[document-origin, * ]</pre>
        <p>
          If the user agent stores explicit lists, the call includes
          one, and the <code>domain</code> argument is provided and is not
          empty, then the database is checked for the existence of all the
          duplets (one per target):
        </p>
        <pre>[*.domain, target]</pre>
        <p>
          If the user agent stores only site-wide exceptions or the call did
          not include an explicit list, and the <code>domain</code> argument
          is provided and is not empty then the database is checked for the
          single duplet:
        </p>
        <pre>[*.domain, * ]</pre>
        <p>
          The returned <code>Promise</code> resolves to a <code>ConfirmExceptionResult</code>
          object whose <code>boolean</code> property <code>exists</code>
          has the following possible values:
        </p>
        <ul>
          <li><code>true</code> all the duplets exist in the database;</li>
          <li><code>false</code> one or more of the duplets does not exist
              in the database.</li>
        </ul>
      </section>
    </section>

    <section id="exceptions-ww-javascript-api">
      <h3>Web-wide Exceptions</h3>

      <section id="exceptions-javascript-api-ww-rqst">
        <h4>API to Request a Web-wide Exception</h4>

        <p>
          <code><dfn>Navigator.storeWebWideTrackingException</dfn></code>
          is called by a page to request the addition of a web-wide grant for a
          specific site to the database.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
            Promise&lt;void&gt; storeWebWideTrackingException (
                            StoreExceptionPropertyBag properties
                          );
        };
        </pre>
        <p>
          <a>Navigator.storeWebWideTrackingException</a> passes a
          <a>StoreExceptionPropertyBag</a>, as described in
          <a href="#exceptions-javascript-api-rqst" class="sectionRef"></a>.
        </p>
        <p>
          The single duplet
          <code>[ * , document-origin]</code> or
          <code>[ * , *.domain]</code> (based on if <code>domain</code>
          is provided and is not null and not empty)
          is added to the database of remembered grants.
        </p>
      </section>

      <section id="exceptions-javascript-api-ww-cancel">
        <h4>API to Cancel a Web-wide Exception</h4>

        <p>
          <code><dfn>Navigator.removeWebWideTrackingException</dfn></code>
          is called by a page to request the removal of a web-wide grant for a
          specific site from the database.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
            Promise&lt;void&gt; removeWebWideTrackingException (
                            RemoveExceptionPropertyBag properties
                          );
        };
        </pre>
        <p>
          <a>Navigator.removeWebWideTrackingException</a> passes a
          <a>RemoveExceptionPropertyBag</a>, as described in
          <a href="#exceptions-javascript-api-cancel" class="sectionRef"></a>.
        </p>
        <p>
          Ensures that the database of remembered grants no longer
          contains the duplet <code>[ * , document-origin]</code>
          or <code>[ * , *.domain]</code> (based on if <code>domain</code>
          is provided and is not null and not empty).
        </p>
        <p>
          A <code>Promise</code> resolving to <code>void</code> is returned.
          When the <code>Promise</code> is resolved, the
          indicated pair is assured not to be in the database. The same
          matching process defined for determining which header field to
          send is also used to detect which entry (if any) to remove from
          the database.
        </p>
      </section>

      <section id="exceptions-javascript-api-ww-confirm">
        <h4>API to Confirm a Web-wide Exception</h4>

        <p>
          <code><dfn>Navigator.confirmWebWideTrackingException</dfn></code>
          is called by a page to confirm that there exists in the database a
          web-wide exception for a specific site.
        </p>
        <pre class="idl overlarge">
        partial interface Navigator {
          Promise&lt;ConfirmExceptionResult&gt; confirmWebWideTrackingException (
            ConfirmSiteSpecificExceptionPropertyBag properties
          );
        };
        dictionary ConfirmExceptionResult {
          boolean exists;
        };	
        </pre>
        <p>
          <a>Navigator.confirmWebWideTrackingException</a> passes a
          <a>ConfirmExceptionPropertyBag</a>, as described in
          <a href="#exceptions-javascript-api-confirm" class="sectionRef"></a>.
        </p>
        <p>
          The returned <code>Promise</code> resolves to a <code>TrackingExceptionResult</code>
          object with a <code>boolean</code> property <code>exists</code> indicating whether the duplet
          <code>[ * , document-origin]</code> or <code>[ * , *.domain]</code>
          (based on if <code>domain</code> is provided and is not null and
          not empty) exists in the database.
        </p>
        <ul>
          <li><code>true</code> indicates that the web-wide exception
            exists;</li>
          <li><code>false</code> indicates that the web-wide exception 
            does not exist.</li>
        </ul>
      </section>
    </section>

    <section id="exceptions-ui" class="informative">
      <h3>User Interface Guidelines</h3>

      <p>
        As described above, it is the sole responsibility of the site
        making an API call to determine that an exception grant reflects the
        user's informed consent at the time of the call.
      </p>
      <p>
        It is expected that a site will explain to the user, in its online
        content, the need for an exception and the consequences of granting or
        denying that exception.
      </p>
      <p>
        User agents are free to implement exception management user
        interfaces as they see fit. Some agents might provide a notification
        to the user at the time of the request, or even not complete the
        storing of the exception until the user approves. Some agents might
        provide a user-interface to see and edit the database of recorded
        exception grants. The API parameters siteName, explanationString,
        and detailURI are provided so that the user agent can use them in
        their user interface. If a user agent presents these parameters to the
        user, it ought to be clear that they are provided for informational
        value and are less important than the exception's technical effect.
      </p>
      <p>
        A user agent that chooses to highlight when tracking exceptions have
        been stored might provide an interface like the following:
      </p>
      <ul>
        <li>an icon in the status bar indicating that an exception has been
          stored, which, when clicked on, gives the user more information
          about the exception and an option to revoke such an exception.</li>
        <li>an infobar stating "Example News (news.example.com) has
          indicated to Browser that you have consented to granting it
          exceptions to your general Do Not Track preference. If you believe
          this is incorrect, click Revoke."</li>
        <li>no UI at all.</li>
      </ul>
      <p>
        In some user agent implementations, decisions to grant exceptions
        might have been made in the past (and since forgotten) or might have
        been made by other users of the device. Thus, exceptions might not
        always represent the current preferences of the user. Some user
        agents might choose to provide ambient notice that user-opted
        tracking is ongoing, or easy access to view and control these
        preferences. Users might also desire to edit exceptions within a
        separate user interface, which would allow a user to modify their
        stored exceptions without visiting the target sites.
      </p>
    </section>

    <section id="exceptions-no-js" class="informative">
      <h3>Exceptions without Interactive JavaScript</h3>

      <p>
        Some third party servers that might wish to receive a user-granted
        exception do not have the ability to invoke an interactive JavaScript
        presence on a page (for example, those that provide only images or
        "tracking pixels"). They cannot request an exception under these
        circumstances, both because a script is needed, and because they would
        be required to explain to the user the need for and consequences of
        granting an exception, and get the user's consent. In general, this
        process of informing, getting consent, and calling the API is not
        expected within page elements where such trackers are invoked.
      </p>
      <p>
        To obtain an exception, a document (page, frame, etc.) that loads
        the Javascript is needed. The user might visit the site that desires
        an exception directly, the first party site could load a frame of
        the site desiring the exception, or that frame might be part of some
        other page containing a number of frames, which allows aggregation
        of requests for exceptions.
      </p>
      <p>
        In all these ways, the site is contributing to informing the user and
        obtaining their consent, while enabling a call to the Javascript API
        when such consent is granted.
      </p>
    </section>

    <section id="exceptions-when-not-enabled">
      <h3>Exceptions without an Expressed Preference</h3>

      <p>
        Sites might wish to request exceptions even when a user arrives
        without a DNT header field. Users might wish to grant affirmative
        permission to tracking on or by certain sites even without
        expressing a general tracking preference.
      </p>
      <p>
        User agents MAY instantiate
        <code>navigator.storeSiteSpecificTrackingException</code> even when
        <code>window.doNotTrack</code> is null. Scripts SHOULD test for the
        existence of <code>storeSiteSpecificTrackingException</code> before
        calling the method. If an exception is granted and the user agent
        stores that preference, a user agent might send the
        <a>DNT:0</a> tracking preference even if it has not
        enabled preferences to be sent for other requests. Persisted
        preferences MAY affect which preference is transmitted if a user
        later chooses to express a tracking preference.
      </p>
      <p class="note">
        Users might not configure their agents to have simple values for
        DNT, but use different browsing modes or other contextual
        information to decide on a DNT value. What algorithm a user agent
        employs to determine DNT values (or the lack thereof) is out of the
        scope of this specification.
      </p>
    </section>
    
    <section id="exceptions-by-sites" class="informative">
      <h3>Exception Use by Sites</h3>

      <p>
        This section is to inform the authors of sites on some
        considerations in using the exceptions APIs to best effect; sites of
        particular interest here are those that need an exception in order
        to allow the user to perform some operation or to have some access.
      </p>
      <p>
        The 'Store' calls return immediately, without a return value.
        If there is a problem with the calling parameters, then
        a Javascript exception will be raised.
      </p>
      <p>
        A user agent might not store the exception immediately, possibly
        because it is allowing the user to confirm. Even though the site has
        acquired the user's informed consent before calling the 'Store' API,
        it is possible that the user will change their mind, allow the
        storing of an exception to proceed but later remove it, or perhaps
        deny the storage by prior configuration.
      </p>
      <p>
        Nonetheless, at the time of the call, the site has acquired the
        user's consent and can proceed on that basis, whether or not the
        user-agent has stored the exception immediately. It is not necessary
        to call the confirm API at the time of consent.
      </p>
      <p>
        On other visits, a site can call the 'Confirm' APIs to enquire
        whether a specific exception has been granted and stands in the user
        agent. This is the call to make to determine whether the exception
        exists, and hence to control access to the function or operation; if
        it fails (the exception has been deleted or not yet granted), then
        the user is ideally again offered the information needed to give
        their informed consent, and again offered the opportunity to
        indicate that they grant it. As stated in the normative text, the
        site needs to explain and acquire consent immediately prior to
        calling the Store API, and not remember some past consent; this
        allows a user to change their mind.
      </p>
      <p>
        If they do grant it (using some positive interaction such as a
        button), the site can return to checking the 'Confirm' API.
      </p>
      <p>
        In this way the site:
      </p>
      <ul>
        <li>does not assume that the storage is instantaneous and
          mistakenly grant access when the exception does not (yet) stand;</li>
        <li>does not call the Confirm API repeatedly, in a loop, without a
          user-interaction between each call; and,</li>
        <li>permits the user the opportunity to delete a previously
        granted exception.</li>
        </ul>
    </section>

  </section>

  <section id='security'>
    <h2>Security Considerations</h2>

    <p>
      TBD.
    </p>
  </section>

  <section id='privacy'>
    <h2>Privacy Considerations</h2>

    <section id='privacy.fingerprinting'>
      <h3>Fingerprinting</h3>

      <p>
        User-granted exceptions to Do Not Track come with a privacy 
		risk. By storing a client-side configurable state and providing
        functionality to learn about it later, this API might facilitate
        user fingerprinting and tracking. User agent developers ought to
        consider the possibility of fingerprinting during implementation and
        might consider rate-limiting requests or using other heuristics to
        mitigate fingerprinting risk.
      </p>
  </section>
</section>

  <section id="acks" class='appendix'>
    <h2>Acknowledgements</h2>

    <p>
      This specification consists of input from many discussions within
      and around the W3C Tracking Protection Working Group, along with
      written contributions from
      Adrian&nbsp;Bateman (Microsoft),
      Justin&nbsp;Brookman (CDT),
      Nick&nbsp;Doty (W3C/MIT),
      Marcos&nbsp;Caceres (Mozilla),
      Rob&nbsp;van&nbsp;Eijk (Invited Expert),
      Roy&nbsp;T.&nbsp;Fielding (Adobe),
      Vinay&nbsp;Goel (Adobe),
      Tom&nbsp;Lowenthal (Mozilla),
      Jonathan&nbsp;Mayer (Stanford),
      Aleecia&nbsp;M.&nbsp;McDonald (Stanford),
      Mike&nbsp;O'Neill (Baycloud Systems),
      Matthias&nbsp;Schunter (Intel),
      John&nbsp;Simpson (Consumer Watchdog),
      David&nbsp;Singer (Apple),
      Rigo&nbsp;Wenning (W3C/ERCIM),
      Shane&nbsp;Wiley (Yahoo!),
      and Andy&nbsp;Zeigler (Microsoft).
    </p>
    <p>
      The DNT header field is based on the original <em>Do Not Track</em>
      submission by Jonathan&nbsp;Mayer (Stanford), Arvind&nbsp;Narayanan
      (Stanford), and Sid&nbsp;Stamm (Mozilla).
      The JavaScript DOM property for <code>doNotTrack</code> is based on the
      <em>Web Tracking Protection</em> submission by Andy&nbsp;Zeigler,
      Adrian&nbsp;Bateman, and Eliot&nbsp;Graff (Microsoft).
      Many thanks to Robin&nbsp;Berjon for ReSpec.js.
    </p>
  </section>

  <section id="registrations" class='appendix'>
    <h2>Registrations</h2>

    <p>
      The Internet media type <a>application/tracking-status+json</a> is
      used for tracking status representations
      (<a href="#status-representation" class="sectionRef"></a>).
    </p>
    <dl>
      <dt>Type name:</dt><dd>application</dd>
      <dt>Subtype name:</dt><dd>tracking-status+json</dd>
      <dt>Required parameters:</dt><dd>N/A</dd>
      <dt>Optional parameters:</dt><dd>N/A</dd>
      <dt>Encoding considerations:</dt><dd>binary</dd>
      <dt>Security considerations:</dt>
        <dd>See JSON [RFC7159], Section 12.</dd>
      <dt>Interoperability considerations:</dt><dd>N/A</dd>
      <dt>Published specification:</dt>
        <dd>Tracking Preference Expression (DNT),
          <a href="#status-representation" class="sectionRef"></a>.<br />
          https://www.w3.org/TR/tracking-dnt/</dd>
      <dt>Applications that use this media type:</dt><dd>N/A</dd>
      <dt>Fragment identifier considerations:</dt><dd>N/A</dd>
      <dt>Additional information:</dt>
        <dd>
          Deprecated alias names for this type: N/A<br />
          Magic number(s): N/A<br />
          File extension(s): N/A<br />
          Macintosh file type code(s): N/A
        </dd>
      <dt>Person &amp; email address to contact for further information:</dt>
        <dd>W3C Tracking Protection Working Group &lt;public-tracking@w3.org&gt;</dd>
      <dt>Intended usage:</dt><dd>COMMON</dd>
      <dt>Restrictions on usage:</dt><dd>N/A</dd>
      <dt>Author(s):</dt><dd>Roy T. Fielding and David Singer</dd>
      <dt>Change controller:</dt><dd>W3C</dd>
    </dl>
  </section>
</body>
</html>
